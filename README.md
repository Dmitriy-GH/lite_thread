# lite_thread.h

Кросплатформенная библиотека на С++11 для легкого распараллеливания кода, в т.ч. потокоНЕбезопасного.

Все исходники и документация в lite_thread.h 

Библиотека построена по Модели Акторов, т.е. общий алгоритм разбивается на акторы (код, атомарные 
части бизнес-логики) и акторы общаются между собой пересылкой сообщений друг-другу. 

Библиотека сама создает нужное количество потоков и запускает в них акторы. 

Библиотека гарантирует что актор не будет запущен одновременно в нескольких потоках, т.е. код актора 
не требует потокобезопасности. Но если актор потокобезопасный (например актор без окружения, все 
необходимое для его работы содержится в сообщении), то его можно разрешить запускать одновременно в
разных потоках с установкой ограничения на количество параллельных запусков.

Есть ограничение доступа группы акторов к конкретному ресурсу. Например можно ограничить общее количество 
потоков для всех акторов активно использующих процессор.

Есть именование акторов, контроль типов сообщений, обработчик ошибок и ведение лога.

### Примеры использования

**test** примеры простейшего использования с выводом в консоль результата работы

**stress_test** нагрузочный тест для проверки работоспособности библиотеки

**card_raytracer** пример преобразования обычного последовательного алгоритма в алгоритм с использованием 
акторов и многопоточности.


### Простейший пример использования

	void actor1(lite_msg_t* msg, void* env) {
		int* x = lite_msg_data<int>(msg);			// Указатель на содержимое сообщения
		if(x == NULL) ...							// Сообщение имеет другой тип, обработка ошибки 
		работа с *x
	}

	void main() {
		lite_msg_t* msg = lite_msg_create<int>();	// Создание сообщения 
		int* x = lite_msg_data<int>(msg);			// Указатель на содержимое сообщения
		*x = 100500;								// Заполнение сообщения
		lite_thread_run(msg, actor1);				// Отправка msg в actor1()
		lite_thread_end();							// Ожидание завершения работы
	}


